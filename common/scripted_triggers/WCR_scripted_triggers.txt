# General utility triggers

# Is this even useful? lol
WCR_is_active_trigger = {
    if = {
        limit = {
            has_global_variable = WCR_is_active
        }
        value = yes
    }
    else = {
        value = no
    }
}

# Check if member of the army
WCR_army_clothes_trigger = {
    OR = {
        scope:pop ?= {
            OR = {
                # Pop works in army building
                workplace ?= {
                    OR = {
                        is_building_type = building_barracks
                        is_building_type = building_conscription_center
                    }
                }
                
                # Military pop that got fired (fallback)
                AND = {
                    NOT = {
                        exists = workplace
                    }
                    OR = {
                        is_pop_type = soldiers
                        is_pop_type = officers
                    }
                }
            }
        }
        OR = {
            # Armed Forces IG leader who isn't a general or admiral
            AND = {
                armed_forces_clothes_trigger = yes
                politician_clothes_trigger = yes
                scope:character ?= {
                    NOT = {
                        has_role = admiral
                    }
                }
            }
            
            # Generals
            scope:character ?= {
                has_role = general
            }
        }
    }
}

# Check if member of the navy
WCR_navy_clothes_trigger = {
    OR = {
        scope:pop ?= {
            always = yes
            workplace ?= {
                is_building_type = building_naval_base
            }
        }
        scope:character ?= {
            has_role = admiral
        }
    }
}

# Check if country, character, or pop is considered westernized
WCR_is_westernized_trigger = {
    OR = {
        scope:pop ?= {
            OR = {
                WCR_st_is_part_west_pop_westernized_trigger = yes
                owner ?= {
                    WCR_st_is_country_westernized = yes
                }
                home_country ?= {
                    WCR_st_is_country_westernized = yes
                }
                
            }
        }
        scope:character ?= {
            OR = {
                WCR_st_is_part_west_character_westernized_trigger = yes
                owner ?= {
                    WCR_st_is_country_westernized = yes
                }
                home_country ?= {
                    WCR_st_is_country_westernized = yes
                }
            }
        }
        scope:country ?= {
            WCR_st_is_country_westernized = yes
        }
    }
}

# Check if country, character, or pop is considered westernized, but EXCLUDING those that begin westernized at game start
WCR_has_completed_westernization_trigger = {
    OR = {
        scope:pop ?= {
            OR = {
                WCR_st_is_part_west_pop_westernized_trigger = yes
                owner ?= {
                    has_variable = WCR_westernized_nation
                    THIS.var:WCR_westernized_nation = yes
                }
                home_country ?= {
                    has_variable = WCR_westernized_nation
                    THIS.var:WCR_westernized_nation = yes
                }
                
            }
        }
        scope:character ?= {
            OR = {
                WCR_st_is_part_west_character_westernized_trigger = yes
                owner ?= {
                    has_variable = WCR_westernized_nation
                    THIS.var:WCR_westernized_nation = yes
                }
                home_country ?= {
                    has_variable = WCR_westernized_nation
                    THIS.var:WCR_westernized_nation = yes
                }
            }
        }
        scope:country ?= {
            has_variable = WCR_westernized_nation
            THIS.var:WCR_westernized_nation = yes
        }
    }
}

# ==================================================================================================================== #

# Westernization influence triggers

WCR_ruler_has_american_influence_trigger = {
    scope:character ?= {
        owner ?= {
            has_variable = WCR_ruler_influence
            THIS.var:WCR_ruler_influence = 1
        }
        home_country ?= {
            has_variable = WCR_ruler_influence
            THIS.var:WCR_ruler_influence = 1
        }
    }
}
WCR_ruler_has_british_influence_trigger = {
    scope:character ?= {
        owner ?= {
            has_variable = WCR_ruler_influence
            THIS.var:WCR_ruler_influence = 2
        }
        home_country ?= {
            has_variable = WCR_ruler_influence
            THIS.var:WCR_ruler_influence = 2
        }
    }
}
WCR_ruler_has_french_influence_trigger = {
    scope:character ?= {
        owner ?= {
            has_variable = WCR_ruler_influence
            THIS.var:WCR_ruler_influence = 3
        }
        home_country ?= {
            has_variable = WCR_ruler_influence
            THIS.var:WCR_ruler_influence = 3
        }
    }
}
WCR_ruler_has_german_influence_trigger = {
    scope:character ?= {
        owner ?= {
            has_variable = WCR_ruler_influence
            THIS.var:WCR_ruler_influence = 4
        }
        home_country ?= {
            has_variable = WCR_ruler_influence
            THIS.var:WCR_ruler_influence = 4
        }
    }
}
WCR_ruler_has_no_influence_trigger = {
    WCR_ruler_has_american_influence_trigger = no
    WCR_ruler_has_british_influence_trigger  = no
    WCR_ruler_has_french_influence_trigger   = no
    WCR_ruler_has_german_influence_trigger   = no
}

WCR_army_has_american_influence_trigger = {
    OR = {
        scope:pop ?= {
            owner ?= {
                has_variable = WCR_army_influence
                THIS.var:WCR_army_influence = 1
            }
            home_country ?= {
                has_variable = WCR_army_influence
                THIS.var:WCR_army_influence = 1
            }
        }
        scope:character ?= {
            owner ?= {
                has_variable = WCR_army_influence
                THIS.var:WCR_army_influence = 1
            }
            home_country ?= {
                has_variable = WCR_army_influence
                THIS.var:WCR_army_influence = 1
            }
        }
    }
}
WCR_army_has_british_influence_trigger = {
    OR = {
        scope:pop ?= {
            owner ?= {
                has_variable = WCR_army_influence
                THIS.var:WCR_army_influence = 2
            }
            home_country ?= {
                has_variable = WCR_army_influence
                THIS.var:WCR_army_influence = 2
            }
        }
        scope:character ?= {
            owner ?= {
                has_variable = WCR_army_influence
                THIS.var:WCR_army_influence = 2
            }
            home_country ?= {
                has_variable = WCR_army_influence
                THIS.var:WCR_army_influence = 2
            }
        }
    }
}
WCR_army_has_french_influence_trigger = {
    OR = {
        scope:pop ?= {
            owner ?= {
                has_variable = WCR_army_influence
                THIS.var:WCR_army_influence = 3
            }
            home_country ?= {
                has_variable = WCR_army_influence
                THIS.var:WCR_army_influence = 3
            }
        }
        scope:character ?= {
            owner ?= {
                has_variable = WCR_army_influence
                THIS.var:WCR_army_influence = 3
            }
            home_country ?= {
                has_variable = WCR_army_influence
                THIS.var:WCR_army_influence = 3
            }
        }
    }
}
WCR_army_has_german_influence_trigger = {
    OR = {
        scope:pop ?= {
            owner ?= {
                has_variable = WCR_army_influence
                THIS.var:WCR_army_influence = 4
            }
            home_country ?= {
                has_variable = WCR_army_influence
                THIS.var:WCR_army_influence = 4
            }
        }
        scope:character ?= {
            owner ?= {
                has_variable = WCR_army_influence
                THIS.var:WCR_army_influence = 4
            }
            home_country ?= {
                has_variable = WCR_army_influence
                THIS.var:WCR_army_influence = 4
            }
        }
    }
}
WCR_army_has_no_influence_trigger = {
    WCR_army_has_american_influence_trigger = no
    WCR_army_has_british_influence_trigger  = no
    WCR_army_has_french_influence_trigger   = no
    WCR_army_has_german_influence_trigger   = no
}

WCR_navy_has_american_influence_trigger = {
    OR = {
        scope:pop ?= {
            owner ?= {
                has_variable = WCR_navy_influence
                THIS.var:WCR_navy_influence = 1
            }
            home_country ?= {
                has_variable = WCR_navy_influence
                THIS.var:WCR_navy_influence = 1
            }
        }
        scope:character ?= {
            owner ?= {
                has_variable = WCR_navy_influence
                THIS.var:WCR_navy_influence = 1
            }
            home_country ?= {
                has_variable = WCR_navy_influence
                THIS.var:WCR_navy_influence = 1
            }
        }
    }
}
WCR_navy_has_british_influence_trigger = {
    OR = {
        scope:pop ?= {
            owner ?= {
                has_variable = WCR_navy_influence
                THIS.var:WCR_navy_influence = 2
            }
            home_country ?= {
                has_variable = WCR_navy_influence
                THIS.var:WCR_navy_influence = 2
            }
        }
        scope:character ?= {
            owner ?= {
                has_variable = WCR_navy_influence
                THIS.var:WCR_navy_influence = 2
            }
            home_country ?= {
                has_variable = WCR_navy_influence
                THIS.var:WCR_navy_influence = 2
            }
        }
    }
}
WCR_navy_has_french_influence_trigger = {
    OR = {
        scope:pop ?= {
            owner ?= {
                has_variable = WCR_navy_influence
                THIS.var:WCR_navy_influence = 3
            }
            home_country ?= {
                has_variable = WCR_navy_influence
                THIS.var:WCR_navy_influence = 3
            }
        }
        scope:character ?= {
            owner ?= {
                has_variable = WCR_navy_influence
                THIS.var:WCR_navy_influence = 3
            }
            home_country ?= {
                has_variable = WCR_navy_influence
                THIS.var:WCR_navy_influence = 3
            }
        }
    }
}
WCR_navy_has_german_influence_trigger = {
    OR = {
        scope:pop ?= {
            owner ?= {
                has_variable = WCR_navy_influence
                THIS.var:WCR_navy_influence = 4
            }
            home_country ?= {
                has_variable = WCR_navy_influence
                THIS.var:WCR_navy_influence = 4
            }
        }
        scope:character ?= {
            owner ?= {
                has_variable = WCR_navy_influence
                THIS.var:WCR_navy_influence = 4
            }
            home_country ?= {
                has_variable = WCR_navy_influence
                THIS.var:WCR_navy_influence = 4
            }
        }
    }
}
WCR_navy_has_no_influence_trigger = {
    WCR_navy_has_american_influence_trigger = no
    WCR_navy_has_british_influence_trigger  = no
    WCR_navy_has_french_influence_trigger   = no
    WCR_navy_has_german_influence_trigger   = no
}

# ==================================================================================================================== #

# Internal use scripted triggers
# WCR will not call these from other files, but if you're looking for extra stuff as a modder, feel free to try them out

WCR_st_is_country_westernized = {
    OR = {
        # Option A: They completed westernization
        AND = {
            has_variable = WCR_westernized_nation
            THIS.var:WCR_westernized_nation = yes
        }
        
        # Option B: They start off westernized
        AND = {
            # Westernized check
            OR = {
                # Option I: They're European (duh)
                any_primary_culture = {
                    has_discrimination_trait = european_heritage
                }
                
                # Option II: Christian religion (helps catch European colonies and former colonies)
                religion = {
                    has_discrimination_trait = christian
                }
            }
            
            # Exclusions
            NOR = {
                THIS = c:PLY # Exclude Tahiti (Polynesia?)
                THIS = c:PHI # Exclude the Philippines
                country_has_state_religion = rel:oriental_orthodox # Exclude Ethiopian kingdoms
            }
        }
    }
}

# Placeholder
# Intended for partial westernization; will return true if the owner of this pop's westernization progress is high
# enough to westernize this pop
# Intended for internal use only, but if you are a modder looking for triggers to use, feel free to use this
WCR_st_is_part_west_pop_westernized_trigger = {
    always = no
}

# Same as above but for characters, which have a different westernization schedule
WCR_st_is_part_west_character_westernized_trigger = {
    always = no
}
