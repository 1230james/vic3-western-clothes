# Westernization influence triggers

# Country scope
WCR_has_domestic_influence_available_trigger = {
    OR = {
        # Using trigger_if blocks for nicer tooltipping
        trigger_if = {
            limit = {
                WCR_is_korea_trigger = yes
            }
            WCR_is_korea_trigger = yes
        }
        trigger_else_if = {
            limit = {
                WCR_is_japan_trigger = yes
            }
            WCR_is_japan_trigger = yes
        }
        trigger_else_if = {
            limit = {
                WCR_st_is_country_tag = { TAG = TUR }
            }
            WCR_st_is_country_tag = { TAG = TUR }
        }
        trigger_else_if = {
            limit = {
                WCR_st_is_country_tag = { TAG = PER }
                has_dlc_feature = ep1_cosmetics # Vanilla DLC locks them or something
            }
            WCR_st_is_country_tag = { TAG = PER }
        }
        trigger_else_if = {
            limit = {
                WCR_st_is_country_tag = { TAG = EGY }
            }
            WCR_st_is_country_tag = { TAG = EGY }
        }
        trigger_else_if = {
            limit = {
                WCR_st_is_country_tag = { TAG = CHI }
            }
            WCR_st_is_country_tag = { TAG = CHI }
        }
        trigger_else_if = { # Siam Renaissance mod interop
            limit = {
                srm_is_active = yes
                WCR_st_is_country_tag = { TAG = SIA }
            }
            WCR_st_is_country_tag = { TAG = SIA }
        }
    }
}

# Character/pop scope
WCR_st_owner_or_home_var_check = {
    trigger_if = {
        limit = {
            exists = owner
        }
        owner ?= {
            has_variable   = $VAR$
            THIS.var:$VAR$ = $IS_EQ_TO$
        }
    }
    trigger_else = {
        home_country ?= {
            has_variable   = $VAR$
            THIS.var:$VAR$ = $IS_EQ_TO$
        }
    }
}

WCR_st_owner_or_home_uses_vanilla_rules = {
    trigger_if = {
        limit = {
            OR = { # If the game rules aren't on then don't even bother to save CPU time
                has_game_rule = WCR_vanilla_KOR_westernization
                has_game_rule = WCR_vanilla_JAP_westernization
            }
        }
        trigger_if = {
            limit = {
                exists = owner
            }
            owner ?= {
                WCR_is_using_vanilla_rules = yes
            }
        }
        trigger_else = {
            home_country ?= {
                WCR_is_using_vanilla_rules = yes
            }
        }
    }
    trigger_else = {
        always = no
    }
}

# Scope-agnostic
WCR_ruler_has_american_influence_trigger = {
    scope:character ?= {
        WCR_st_owner_or_home_var_check = {
            VAR      = WCR_ruler_influence
            IS_EQ_TO = 1
        }
    }
}
WCR_ruler_has_british_influence_trigger = {
    scope:character ?= {
        WCR_st_owner_or_home_var_check = {
            VAR      = WCR_ruler_influence
            IS_EQ_TO = 2
        }
    }
}
WCR_ruler_has_french_influence_trigger = {
    scope:character ?= {
        WCR_st_owner_or_home_var_check = {
            VAR      = WCR_ruler_influence
            IS_EQ_TO = 3
        }
    }
}
WCR_ruler_has_german_influence_trigger = {
    scope:character ?= {
        WCR_st_owner_or_home_var_check = {
            VAR      = WCR_ruler_influence
            IS_EQ_TO = 4
        }
    }
}
WCR_ruler_has_russian_influence_trigger = {
    scope:character ?= {
        WCR_st_owner_or_home_var_check = {
            VAR      = WCR_ruler_influence
            IS_EQ_TO = 5
        }
    }
}
WCR_ruler_has_domestic_influence_trigger = {
    scope:character ?= {
        OR = {
            WCR_st_owner_or_home_var_check = {
                VAR      = WCR_ruler_influence
                IS_EQ_TO = -1
            }
            WCR_st_owner_or_home_uses_vanilla_rules = yes
        }
    }
}
WCR_ruler_has_no_influence_trigger = {
    WCR_ruler_has_american_influence_trigger = no
    WCR_ruler_has_british_influence_trigger  = no
    WCR_ruler_has_french_influence_trigger   = no
    WCR_ruler_has_german_influence_trigger   = no
    WCR_ruler_has_russian_influence_trigger  = no
    WCR_ruler_has_domestic_influence_trigger = no
}

WCR_army_has_american_influence_trigger = {
    OR = {
        scope:pop ?= {
            WCR_st_owner_or_home_var_check = {
                VAR      = WCR_army_influence
                IS_EQ_TO = 1
            }
        }
        scope:character ?= {
            WCR_st_owner_or_home_var_check = {
                VAR      = WCR_army_influence
                IS_EQ_TO = 1
            }
        }
    }
}
WCR_army_has_british_influence_trigger = {
    OR = {
        scope:pop ?= {
            WCR_st_owner_or_home_var_check = {
                VAR      = WCR_army_influence
                IS_EQ_TO = 2
            }
        }
        scope:character ?= {
            WCR_st_owner_or_home_var_check = {
                VAR      = WCR_army_influence
                IS_EQ_TO = 2
            }
        }
    }
}
WCR_army_has_french_influence_trigger = {
    OR = {
        scope:pop ?= {
            WCR_st_owner_or_home_var_check = {
                VAR      = WCR_army_influence
                IS_EQ_TO = 3
            }
        }
        scope:character ?= {
            WCR_st_owner_or_home_var_check = {
                VAR      = WCR_army_influence
                IS_EQ_TO = 3
            }
        }
    }
}
WCR_army_has_german_influence_trigger = {
    OR = {
        scope:pop ?= {
            WCR_st_owner_or_home_var_check = {
                VAR      = WCR_army_influence
                IS_EQ_TO = 4
            }
        }
        scope:character ?= {
            WCR_st_owner_or_home_var_check = {
                VAR      = WCR_army_influence
                IS_EQ_TO = 4
            }
        }
    }
}
WCR_army_has_russian_influence_trigger = {
    OR = {
        scope:pop ?= {
            WCR_st_owner_or_home_var_check = {
                VAR      = WCR_army_influence
                IS_EQ_TO = 5
            }
        }
        scope:character ?= {
            WCR_st_owner_or_home_var_check = {
                VAR      = WCR_army_influence
                IS_EQ_TO = 5
            }
        }
    }
}
WCR_army_has_domestic_influence_trigger = {
    OR = {
        scope:pop ?= {
            OR = {
                WCR_st_owner_or_home_var_check = {
                    VAR      = WCR_army_influence
                    IS_EQ_TO = -1
                }
                WCR_st_owner_or_home_uses_vanilla_rules = yes
            }
        }
        scope:character ?= {
            OR = {
                WCR_st_owner_or_home_var_check = {
                    VAR      = WCR_army_influence
                    IS_EQ_TO = -1
                }
                WCR_st_owner_or_home_uses_vanilla_rules = yes
            }
        }
    }
}
WCR_army_has_no_influence_trigger = {
    WCR_army_has_american_influence_trigger = no
    WCR_army_has_british_influence_trigger  = no
    WCR_army_has_french_influence_trigger   = no
    WCR_army_has_german_influence_trigger   = no
    WCR_army_has_russian_influence_trigger  = no
    WCR_army_has_domestic_influence_trigger = no
}

WCR_navy_has_american_influence_trigger = {
    OR = {
        scope:pop ?= {
            WCR_st_owner_or_home_var_check = {
                VAR      = WCR_navy_influence
                IS_EQ_TO = 1
            }
        }
        scope:character ?= {
            WCR_st_owner_or_home_var_check = {
                VAR      = WCR_navy_influence
                IS_EQ_TO = 1
            }
        }
    }
}
WCR_navy_has_british_influence_trigger = {
    OR = {
        scope:pop ?= {
            WCR_st_owner_or_home_var_check = {
                VAR      = WCR_navy_influence
                IS_EQ_TO = 2
            }
        }
        scope:character ?= {
            WCR_st_owner_or_home_var_check = {
                VAR      = WCR_navy_influence
                IS_EQ_TO = 2
            }
        }
    }
}
WCR_navy_has_french_influence_trigger = {
    OR = {
        scope:pop ?= {
            WCR_st_owner_or_home_var_check = {
                VAR      = WCR_navy_influence
                IS_EQ_TO = 3
            }
        }
        scope:character ?= {
            WCR_st_owner_or_home_var_check = {
                VAR      = WCR_navy_influence
                IS_EQ_TO = 3
            }
        }
    }
}
WCR_navy_has_german_influence_trigger = {
    OR = {
        scope:pop ?= {
            WCR_st_owner_or_home_var_check = {
                VAR      = WCR_navy_influence
                IS_EQ_TO = 4
            }
        }
        scope:character ?= {
            WCR_st_owner_or_home_var_check = {
                VAR      = WCR_navy_influence
                IS_EQ_TO = 4
            }
        }
    }
}
WCR_navy_has_russian_influence_trigger = {
    OR = {
        scope:pop ?= {
            WCR_st_owner_or_home_var_check = {
                VAR      = WCR_navy_influence
                IS_EQ_TO = 5
            }
        }
        scope:character ?= {
            WCR_st_owner_or_home_var_check = {
                VAR      = WCR_navy_influence
                IS_EQ_TO = 5
            }
        }
    }
}
WCR_navy_has_domestic_influence_trigger = {
    OR = {
        scope:pop ?= {
            OR = {
                WCR_st_owner_or_home_var_check = {
                    VAR      = WCR_navy_influence
                    IS_EQ_TO = -1
                }
                WCR_st_owner_or_home_uses_vanilla_rules = yes
            }
        }
        scope:character ?= {
            OR = {
                WCR_st_owner_or_home_var_check = {
                    VAR      = WCR_navy_influence
                    IS_EQ_TO = -1
                }
                WCR_st_owner_or_home_uses_vanilla_rules = yes
            }
        }
    }
}
WCR_navy_has_no_influence_trigger = {
    WCR_navy_has_american_influence_trigger = no
    WCR_navy_has_british_influence_trigger  = no
    WCR_navy_has_french_influence_trigger   = no
    WCR_navy_has_german_influence_trigger   = no
    WCR_navy_has_russian_influence_trigger  = no
    WCR_navy_has_domestic_influence_trigger = no
}
